# OCR Numbers 设计说明

## 项目背景

本项目旨在实现一个光学字符识别（OCR）程序，能够将特定的 3x4 字符网格（由管道、下划线和空格组成）转换为数字字符串。项目基于 Java 版本的 OCR Numbers 程序，移植到仓颉语言，并保持功能一致性。

## 设计目标

1. **功能完整性** ：实现从单字符到多行多字符的数字识别，支持 0-9 的数字图案。
2. **可读性与可维护性** ：代码结构清晰，逻辑模块化，易于扩展和维护。
3. **语言适配** ：充分利用仓颉语言的特性，确保代码符合语言规范。

## 设计思路

### 1. 输入处理

* **数据结构** ：使用 `ArrayList<String>` 存储输入的字符网格，每行是一个字符串。
* **验证逻辑** ：
* 检查行数是否为 4 的倍数（每组数字占用 4 行）。
* 检查每行宽度是否为 3 的倍数（每个数字占用 3 列）。
* 若不满足条件，抛出 `IllegalStateException`。

### 2. 数字识别

* **模板存储** ：在 `info` 字符串中存储 0-9 的标准字符图案模板，长度为 120（10 个数字 × 4 行 × 3 列）。
* **匹配逻辑** ：
* 遍历输入的每组 4 行，每 3 列作为一个数字。
* 将输入的 3x4 网格与模板中的每个数字（0-9）进行逐字符比较。
* 如果匹配成功，记录对应数字；否则在检查完所有模板后记录 `?`。

### 3. 输出处理

* **结果构建** ：使用 `StringBuilder` 动态构建每组数字的字符串。
* **多行拼接** ：将多组数字的结果用逗号分隔，生成最终输出字符串。

## 实现细节

* **类结构** ：
* `OpticalCharacterReader` 类封装了核心解析逻辑，`info` 字符串存储数字模板，`parse` 方法实现识别和输出。
* `main` 函数提供测试用例，验证程序功能。
* **异常处理** ：
* 使用仓颉的异常机制（`throw IllegalStateException`）处理非法输入。
* **字符串操作** ：
* 使用仓颉的字符串切片操作（如 `[(3 * col)..(3 * (col + 1))]`）提取 3 列字符。
* 比较输入与模板字符串时，使用直接字符串比较。

## 遇到的问题与解决方案

1. **问题** ：仓颉语言的字符串切片和集合操作与 Java 不同，可能导致语法错误。

* **解决方案** ：参考仓颉语言文档，调整切片语法和集合操作，确保与 Java 逻辑一致。

1. **问题** ：多行输入的拼接逻辑需要避免多余的逗号。

* **解决方案** ：在拼接结果时，判断是否为最后一组数字，避免末尾多余逗号。

1. **问题** ：模板字符串的索引计算复杂，容易出错。

* **解决方案** ：通过数学公式 `3 * (10 * j + i)` 精确定位模板中每个数字的字符位置。
